# Windsurf AI Security Guidelines
# Add these rules to your Windsurf project configuration

## Security-First Code Generation

All code generated by Windsurf should adhere to these security principles:

### Core Security Principles

1. **Defense in Depth**: Apply multiple layers of security controls
2. **Least Privilege**: Request only necessary permissions
3. **Secure by Default**: Choose secure options as defaults
4. **Fail Securely**: Handle errors without exposing sensitive data

### Credential Management

**DO:**
- Use environment variables for secrets
- Use secret management services (Vault, AWS Secrets Manager)
- Rotate credentials regularly

**DON'T:**
- Hardcode any credentials, tokens, or API keys
- Commit secrets to version control
- Log sensitive information

```python
# ✅ Correct
import os
db_password = os.environ.get("DATABASE_PASSWORD")

# ❌ Wrong
db_password = "super_secret_password"
```

### SQL Security

**DO:**
- Use parameterized queries exclusively
- Use ORM methods for database operations
- Validate all input before database operations

**DON'T:**
- Concatenate user input into SQL strings
- Use string formatting for queries
- Trust any external input

```python
# ✅ Correct
cursor.execute("SELECT * FROM users WHERE id = ?", (user_id,))

# ❌ Wrong
cursor.execute(f"SELECT * FROM users WHERE id = {user_id}")
```

### Cryptographic Operations

**DO:**
- Use SHA-256 or SHA-3 for hashing
- Use bcrypt/Argon2 for passwords
- Use secrets module for random values
- Use AES-GCM for encryption

**DON'T:**
- Use MD5 or SHA-1
- Use random module for security
- Implement custom crypto

```python
# ✅ Correct
import secrets
import hashlib

token = secrets.token_urlsafe(32)
hash_val = hashlib.sha256(data).hexdigest()

# ❌ Wrong
import random
token = str(random.randint(0, 1000000))
hash_val = hashlib.md5(data).hexdigest()
```

### Input Validation

**DO:**
- Validate all external input
- Use allowlists for validation
- Sanitize output based on context
- Limit input length and complexity

**DON'T:**
- Trust client-side validation alone
- Use denylists as primary defense
- Pass raw input to sensitive operations

### Network Operations

**DO:**
- Use HTTPS for all external requests
- Verify SSL certificates
- Validate URLs before requests
- Implement proper timeout handling

**DON'T:**
- Disable SSL verification
- Follow redirects blindly
- Expose internal network details

### Serialization

**DO:**
- Use `json.loads()` for JSON
- Use `yaml.safe_load()` for YAML
- Validate structure after deserializing

**DON'T:**
- Use `pickle.loads()` on untrusted data
- Use `yaml.load()` without safe loader
- Deserialize without validation

## Security Review Checklist

Before accepting generated code, verify:
- [ ] No hardcoded secrets
- [ ] Parameterized database queries
- [ ] Modern cryptographic algorithms
- [ ] Input validation present
- [ ] Secure network configuration
- [ ] Safe serialization methods
